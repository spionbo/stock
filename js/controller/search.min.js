define(["views/search","pub","modules/stockData"],function(d,a,c){var e=function(h,i,g,f){e.focusInstance=this;this.url="http://code.jrjimg.cn/code?1=1";this.param=h;this.charset=i;this.success=g;this.failer=f;this.timerDelay="200";this.requestTxt="";this.init()};e.prototype={init:function(f){},requestData:function(f){this.requestTxt=f;var g=this;this.stopRequest();this.timer=setTimeout(function(){var h=g.url+g.param+"&key="+g.requestTxt+"&d="+new Date().getTime();a.getScript([h],function(){g.handleResponse(SCodeData)},g.charset);g.timer=setTimeout(arguments.callee,g.timerDelay)},this.timerDelay)},handleResponse:function(f){if(f.CodeData.length!=0){this.success(f)}else{this.failer(f)}this.stopRequest()},stopRequest:function(){window.clearTimeout(this.timer);this.timer=null}};var b={init:function(g){b.parentElement=g.searchContent;b.Dome=$(d);b.input=b.Dome.find(".input input");b.Dome.appendTo(b.parentElement);b.list=b.Dome.find(".list");b.Dome.find(".tit .back").click(function(){g.goTab(1)});var f=new e("item=20&type=cn_i,s","gb2312",function(m){b.list.html("");var l='<div class="th"><ul><li>股票名称</li><li>代码</li></ul></div><div class="cnt">',k=m.CodeData,h=[];if(k.length!=0){for(var j=0;j<k.length;j++){h.push([k[j]["code"],k[j]["name"],k[j]["type"].split(".")[0]])}}else{h=[]}$.each(h,function(o,n){l+="<ul data-code="+n[0]+"  data-type="+n[2]+"><li>"+n[1]+"</li><li>"+n[0]+"</li></ul>"});b.list.append(l+"</div></div>");b.list.find("ul").each(function(n,o){$(o).click(function(q){q.stopPropagation();var p=$(this).attr("data-code"),i=$(this).attr("data-type");if(p){c.search(p,i,function(){g.goTab(1)})}})})},function(){b.list.html('<div class="error">暂无数据</div>')});b.input.bind("input",function(h){b.list.html('<div class="error">加载中...</div>');f.requestData($(this).val())})},resize:function(){}};return b});